% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/longy.R
\name{longy}
\alias{longy}
\title{High-Level Wrapper for Longitudinal Causal Inference}
\usage{
longy(
  data,
  id,
  time,
  outcome,
  treatment,
  censoring = NULL,
  observation = NULL,
  baseline = character(0),
  timevarying = character(0),
  sampling_weights = NULL,
  outcome_type = "binary",
  regimes = list(always = 1L, never = 0L),
  estimator = "ipw",
  covariates = NULL,
  learners = c("SL.glm", "SL.mean"),
  stabilized = TRUE,
  truncation = NULL,
  truncation_quantile = NULL,
  inference = "ic",
  ci_level = 0.95,
  n_boot = 200L,
  cluster = NULL,
  times = NULL,
  adaptive_cv = TRUE,
  min_obs = 50L,
  bounds = c(0.005, 0.995),
  g_bounds = c(0.01, 1),
  outcome_range = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data.frame or data.table in long format.}

\item{id}{Character. Subject identifier column.}

\item{time}{Character. Time index column.}

\item{outcome}{Character. Outcome column.}

\item{treatment}{Character. Binary treatment column.}

\item{censoring}{Character vector. Censoring column(s) (absorbing). NULL if none.}

\item{observation}{Character. Intermittent observation column. NULL if outcome
always observed.}

\item{baseline}{Character vector. Baseline covariate columns.}

\item{timevarying}{Character vector. Time-varying covariate columns.}

\item{sampling_weights}{Character. Column name for external sampling/survey
weights. See \code{\link[=longy_data]{longy_data()}} for details. NULL if none.}

\item{outcome_type}{Character. \code{"binary"}, \code{"continuous"}, or \code{"survival"}.}

\item{regimes}{Named list. Each element defines a regime:
\itemize{
\item For static: an integer (0 or 1), e.g., \code{list(always = 1L, never = 0L)}
\item For dynamic: a function returning 0/1
\item For stochastic: a function returning P(A=1)
}}

\item{estimator}{Character. Which estimator(s) to use: \code{"ipw"} (default),
\code{"gcomp"}, \code{"tmle"}, \code{"both"} (IPW + G-comp, backward
compatible), or \code{"all"} (IPW + G-comp + TMLE). When multiple
estimators are run, results are returned with \code{_ipw}, \code{_gcomp},
and/or \code{_tmle} suffixes per regime. Nuisance models are shared
across estimators to avoid redundant fitting.}

\item{covariates}{Character vector. Predictor columns for nuisance models.
If NULL, uses all baseline + timevarying.}

\item{learners}{Character vector. SuperLearner library names (default
\code{c("SL.glm", "SL.mean")}). Set to NULL to use plain glm without
SuperLearner.}

\item{stabilized}{Logical. Use stabilized weights (IPW only).}

\item{truncation}{Numeric. Weight truncation cap (IPW only).}

\item{truncation_quantile}{Numeric. Quantile-based weight truncation (IPW only).}

\item{inference}{Character. \code{"ic"}, \code{"bootstrap"}, or \code{"sandwich"}.
Ignored for G-comp (always bootstrap).}

\item{ci_level}{Numeric. Confidence level.}

\item{n_boot}{Integer. Bootstrap replicates.}

\item{cluster}{Character. Cluster column for robust SEs (IPW only).}

\item{times}{Numeric vector. Time points for estimation. NULL = all.}

\item{adaptive_cv}{Logical. Adaptive CV fold selection.}

\item{min_obs}{Integer. Minimum observations for model fitting.}

\item{bounds}{Numeric(2). Prediction probability bounds.}

\item{g_bounds}{Numeric(2). Bounds for cumulative g (denominator of clever
covariate). Default \code{c(0.01, 1)}. Used by TMLE and IPW.}

\item{outcome_range}{Numeric(2) or NULL. Range for scaling continuous
outcomes to \code{[0,1]} in TMLE. If NULL, uses empirical range.
Ignored for binary/survival outcomes.}

\item{verbose}{Logical. Print progress.}
}
\value{
An S3 object of class \code{"longy_results"} (a named list of
\code{longy_result} objects, one per regime). When multiple estimators are
requested, each regime produces entries with \code{_ipw}, \code{_gcomp},
and/or \code{_tmle} suffixes.
}
\description{
Runs the entire longy pipeline in one call: data setup, regime definition,
nuisance model fitting, and estimation via IPW, G-computation, or both.
}
\examples{
\dontrun{
results <- longy(
  data = sim_longy,
  id = "id", time = "time", outcome = "Y",
  treatment = "A", censoring = "C", observation = "R",
  baseline = c("W1", "W2"), timevarying = c("L1", "L2"),
  regimes = list(always = 1L, never = 0L)
)
}

}
